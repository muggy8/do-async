"use strict";!function(a){var b=Array.prototype.forEach,c=Array.prototype.slice;a.doAsync=function(a,d){var e,f;if("string"==typeof a)f=a,e=d;else{if("function"!=typeof a)throw"type missmatch";e=a}var g={length:0};g.addLink=function(a,d){var e=g.length;g.length+=1,g[e]={x:a,y:{},z:[]},d&&(g[d]=g[e]);var f=g[e].y.pass=function(){var a=c.call(arguments);g[e].y.pass==f?g[e].z.push({w:e+1,args:a}):g[e].y.pass.apply(void 0,a)};g[e].y.end=g[e].y.destroy=function(){b.call(g,function(a){a.x=function(){},a.y={},a.z=[]}),h.then=function(){}},g[e].y.jumpTo=g[e].y.jumpto=function(a){return g[a]?function(){var b=c.call(arguments);g[a].x.apply(g[a].y,b)}:function(){var b=c.call(arguments);g[e].z.push({w:a,args:b})}},g[e].y.jump=function(a){var b=e+a;return g[e].y.jumpTo(b)},g[e].y.self=function(){var a=c.call(arguments);g[e].y.jump(0).apply(g[e].y,a)}};var h=function(){var a=c.call(arguments);g[0].x.apply(g[0].y,a)};return h.then=function(a,d){var e,f;if("string"==typeof a||"undefined"==typeof a)f=a,e=d;else{if("function"!=typeof a)throw"type missmatch";e=a}g.addLink(e,f);var i=g.length-1;return i>0&&(g[i-1].y.pass=function(){var a=c.call(arguments);g[i].x.apply(g[i].y,a)},b.call(g,function(a){a.z.forEach(function(a){a.w!=i&&a.w!=f||g[i-1].y.pass.apply(void 0,a.args)})})),h},h.then(f,e),e.length||h(),h},"undefined"!=typeof module&&module.exports&&(module.exports=a.doAsync)}(this);